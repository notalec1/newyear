<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Ultimate Countdown</title>
    <style>
        /* --- 1. CORE STYLES --- */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;700;900&display=swap');

        /* Hide scrollbars */
        body::-webkit-scrollbar { display: none; }
        body { -ms-overflow-style: none; scrollbar-width: none; }

        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at center, #1e3c72 0%, #000000 100%);
            background-attachment: fixed; /* Fixes the blue bar issue */
            color: #ffffff;
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            overflow-y: scroll;
            transition: background 0.5s ease;
        }

        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* --- 2. NOTIFICATIONS (Top Left, Manual Close) --- */
        #milestone-alert {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 159, 67, 0.2); /* Glassy Orange */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 159, 67, 0.6);
            color: #fff;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            z-index: 200;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            display: none; /* Hidden by default */
            align-items: center;
            gap: 15px;
            min-width: 250px;
            animation: slideInLeft 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 80vw;
        }

        @keyframes slideInLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        #alert-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: 0.2s;
        }
        #alert-close:hover { background: rgba(255,255,255,0.4); }

        /* --- 3. HEARTBEAT MODE (Final 10s) --- */
        body.heartbeat-mode {
            /* We must re-declare attachment fixed to prevent jumping */
            background: radial-gradient(circle at center, #800000 0%, #000000 100%);
            background-attachment: fixed;
            animation: bgPulse 1s infinite;
        }
        body.heartbeat-mode .time-box {
            border-color: #ff4d4d;
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.6);
            animation: boxPulse 1s infinite;
        }
        body.heartbeat-mode h1 { color: #ff4d4d; transform: scale(1.1); }
        
        @keyframes bgPulse { 50% { background-size: 110% 110%; } }
        @keyframes boxPulse { 50% { transform: scale(1.05); } }


        /* --- 4. HERO SECTION --- */
        #hero {
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding-bottom: 50px;
        }

        /* CONTROLS */
        #controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-end;
            gap: 8px;
            z-index: 100;
        }

        select, button {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            cursor: pointer;
            transition: 0.3s;
            outline: none;
            font-size: 0.85rem;
        }
        select option { background: #1e3c72; }
        select:hover, button:hover { background: rgba(255, 255, 255, 0.3); }

        .sync-group {
            display: flex;
            gap: 2px;
            align-items: center;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 2px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .sync-btn { border: none; background: transparent; font-weight: bold; padding: 8px 10px; color: white; cursor: pointer; }
        .sync-label { font-size: 0.7rem; padding: 0 5px; opacity: 0.7; text-transform: uppercase; }

        #test-btn { background: rgba(255, 71, 87, 0.2); border-color: rgba(255, 71, 87, 0.5); }
        
        /* COUNTDOWN */
        h1 {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 5px 15px rgba(0,0,0,0.5);
            text-align: center;
            transition: all 0.5s ease;
        }

        #countdown-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            transition: transform 0.5s ease;
        }

        .time-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            min-width: 90px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .number { font-size: 4rem; font-weight: 700; line-height: 1; font-variant-numeric: tabular-nums; }
        .label { font-size: 1rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.8; }

        /* --- 5. FLOATING FACTS (Only visible on celebration) --- */
        .floating-fact {
            position: fixed;
            bottom: -100px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            padding: 12px 25px;
            border-radius: 30px;
            color: #fff;
            font-weight: 600;
            font-size: 1.1rem;
            pointer-events: none;
            z-index: 50;
            border: 1px solid rgba(255,255,255,0.4);
            white-space: nowrap;
            box-shadow: 0 0 20px rgba(255,255,255,0.1);
            animation: floatUp linear forwards;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(0.8); opacity: 0; }
            10% { opacity: 1; transform: translateY(-10vh) scale(1); }
            100% { transform: translateY(-120vh) scale(1); opacity: 0; }
        }

        /* SCROLL HINT */
        .scroll-hint {
            position: absolute;
            bottom: 20px;
            opacity: 0.5;
            animation: bounce 2s infinite;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }

        /* --- 6. LEADERBOARD --- */
        #leaderboard {
            min-height: 100vh;
            width: 100%;
            padding: 50px 20px;
            box-sizing: border-box;
            background: rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .board-container { width: 100%; max-width: 800px; margin-bottom: 50px; }
        .board-title {
            font-size: 1.5rem; margin-bottom: 20px; padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
            color: #ffd700; text-transform: uppercase; letter-spacing: 2px;
        }
        .zone-item {
            display: flex; justify-content: space-between;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px; margin-bottom: 10px; border-radius: 8px;
            backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.05);
        }
        .celebrated .zone-status { color: #00ff80; font-weight: bold; }

        #celebration-message {
            display: none; font-size: 5vw; font-weight: 900; color: #ffd700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.8); text-align: center;
            z-index: 20; animation: textFadeIn 1s ease forwards;
        }
        @keyframes textFadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .number { font-size: 2.5rem; }
            .time-box { min-width: 60px; padding: 10px; }
            #controls { position: relative; width: 100%; justify-content: center; top: 0; right: 0; margin-bottom: 20px; }
            #milestone-alert { top: 10px; left: 10px; right: 10px; min-width: auto; }
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>
    
    <!-- New Top-Left Notification -->
    <div id="milestone-alert">
        <span id="alert-text">Notification</span>
        <button id="alert-close" onclick="closeNotification()">√ó</button>
    </div>

    <!-- Hero Section -->
    <div id="hero">
        <div id="controls">
            <!-- TV Sync -->
            <div class="sync-group" title="Adjust time to match TV broadcast">
                <span class="sync-label">TV Sync</span>
                <button class="sync-btn" onclick="adjustSync(-1)">-1s</button>
                <button class="sync-btn" onclick="adjustSync(1)">+1s</button>
            </div>

            <select id="timezone-select">
                <option value="local">üìç Local Time</option>
                <option value="14">üá∞üáÆ Kiritimati (UTC+14)</option>
                <option value="13">üá≥üáø New Zealand (UTC+13)</option>
                <option value="11">üá¶üá∫ Sydney (UTC+11)</option>
                <option value="9">üáØüáµ Tokyo (UTC+9)</option>
                <option value="8">üá®üá≥ Beijing / üá∏üá¨ SG (UTC+8)</option>
                <option value="7">üáπüá≠ Bangkok (UTC+7)</option>
                <option value="5.5">üáÆüá≥ India (UTC+5:30)</option>
                <option value="4">üá¶üá™ Dubai (UTC+4)</option>
                <option value="3">üá∏üá¶ Riyadh / üá∑üá∫ Moscow (UTC+3)</option>
                <option value="2">üá±üáß Beirut / üá¨üá∑ Athens (UTC+2)</option>
                <option value="1">üá´üá∑ Paris / üá©üá™ Berlin (UTC+1)</option>
                <option value="0">üá¨üáß London (UTC)</option>
                <option value="-5">üá∫üá∏ New York (EST)</option>
                <option value="-6">üá∫üá∏ Chicago (CST)</option>
                <option value="-8">üá∫üá∏ Los Angeles (PST)</option>
            </select>
            
           <!-- <button id="test-btn" onclick="testFinalCountdown()">‚è± Test Final 20s</button> -->
            <button onclick="toggleFullscreen()">‚õ∂ Full</button>
        </div>

        <h1 id="headline">Countdown to 2026</h1>

        <div id="countdown-container">
            <div class="time-box">
                <span class="number" id="days">00</span>
                <span class="label">Days</span>
            </div>
            <div class="time-box">
                <span class="number" id="hours">00</span>
                <span class="label">Hours</span>
            </div>
            <div class="time-box">
                <span class="number" id="minutes">00</span>
                <span class="label">Minutes</span>
            </div>
            <div class="time-box">
                <span class="number" id="seconds">00</span>
                <span class="label">Seconds</span>
            </div>
        </div>

        <div id="celebration-message">HAPPY NEW YEAR!</div>
        <div class="scroll-hint">Scroll for Global Leaderboard ‚ñº</div>
    </div>

    <!-- Leaderboard Section -->
    <div id="leaderboard">
        <div class="board-container">
            <div class="board-title">üéâ Already Celebrated 2026</div>
            <div id="celebrated-list"></div>
        </div>
        <div class="board-container">
            <div class="board-title">‚è≥ Coming Up Next</div>
            <div id="upcoming-list"></div>
        </div>
    </div>

    <script>
        // === CONFIGURATION ===
        const TARGET_YEAR = 2026;
        let syncOffset = 0; // TV Sync Offset

        // === DATA: 20 Floating Facts (Hidden until midnight) ===
        const facts2026 = [
            "Year of the Fire Horse üêé", 
            "FIFA World Cup 2026 (USA/MEX/CAN) ‚öΩ", 
            "Winter Olympics: Milano Cortina ‚õ∑Ô∏è",
            "USA 250th Anniversary üá∫üá∏", 
            "Total Solar Eclipse (Aug 12) üåë", 
            "Easter is April 5th ü•ö",
            "Christmas falls on a Friday üéÑ", 
            "Asian Games in Nagoya üóæ", 
            "Commonwealth Games ü§ù",
            "Le Mans 24h: June 13-14 üèéÔ∏è", 
            "Voyager 2: 49 Years in Space üõ∞Ô∏è", 
            "New Adventures Await ‚ú®",
            "365 New Opportunities üìÖ", 
            "Dream Big in '26 üí≠", 
            "A Fresh Start üå±",
            "Make It Count üíØ", 
            "Be Kind ‚ù§Ô∏è", 
            "The Future is Now üöÄ",
            "52 Weeks of Magic ‚ú®", 
            "Let's Go 2026! üî•",
            "New Tech, Same Old Passwords üîë",
            "Games Get Bigger, Sizes Get Bigger üéÆ",
            "'89 seconds to midnight' ~ Doomsday Clock",
            "Autosave After Disaster üíæ",
            "FLASHBACK",
            "FLASHBACK",
            "FLASHBACK",
            "67 Kid scream meme",
            "Nothing beats a Jet2 Holiday",
            "100 men vs 1 year",
            "Aura farming",
            "Meteque",
            "Online school",
            "AI generated Italian brainrot",
            "Wide putin walking",
            "W Speed ‚ù§Ô∏è‚Äçü©π",
            "ChatGPT wrapped",
            "Spotify 'Age is just a number'",
            "USA stopped making pennies",
            "$9 for eggs??",
            "11a airplane spot",
            "Dubai chocolate trend üç´",
            "Katy Perry went to space"
        ];

        // Wake Lock
        let wakeLock = null;
        async function requestWakeLock() {
            if ('wakeLock' in navigator) {
                try {
                    wakeLock = await navigator.wakeLock.request('screen');
                } catch (err) { console.log(err); }
            }
        }
        document.addEventListener('click', () => { if(!wakeLock) requestWakeLock(); }, { once: true });

        // === TIME ZONES ===
        const timeZoneData = [
            { offset: 14, name: "Kiritimati, Kiribati" }, { offset: 13, name: "Samoa & New Zealand" },
            { offset: 11, name: "Sydney, Australia" }, { offset: 10, name: "Brisbane, Australia" },
            { offset: 9, name: "Tokyo, Japan & Korea" }, { offset: 8, name: "Beijing & Singapore" },
            { offset: 7, name: "Bangkok & Vietnam" }, { offset: 5.5, name: "New Delhi, India" },
            { offset: 4, name: "Dubai, UAE" }, { offset: 3, name: "Riyadh & Moscow" },
            { offset: 2, name: "Beirut, Cairo, Athens" }, { offset: 1, name: "Paris, Berlin, Rome" },
            { offset: 0, name: "London & Lisbon" }, { offset: -3, name: "Rio de Janeiro" },
            { offset: -5, name: "New York (EST)" }, { offset: -6, name: "Chicago (CST)" },
            { offset: -7, name: "Denver (MST)" }, { offset: -8, name: "Los Angeles (PST)" },
            { offset: -10, name: "Hawaii" }
        ];

        const greetings = ["HAPPY NEW YEAR!", "BONNE ANN√âE!", "FELIZ A√ëO NUEVO!", "FROHES NEUES JAHR!", "FELICE ANNO NUOVO!", "Êòé„Åë„Åæ„Åó„Å¶„Åä„ÇÅ„Åß„Å®„ÅÜ!", "ÏÉàÌï¥ Î≥µ ÎßéÏù¥ Î∞õÏúºÏÑ∏Ïöî!", "Êñ∞Âπ¥Âø´‰πê!", "SANA SAIDAH!", "FELIZ ANO NOVO!"];

        const els = {
            days: document.getElementById('days'), hours: document.getElementById('hours'),
            minutes: document.getElementById('minutes'), seconds: document.getElementById('seconds'),
            container: document.getElementById('countdown-container'), headline: document.getElementById('headline'),
            message: document.getElementById('celebration-message'), select: document.getElementById('timezone-select'),
            alert: document.getElementById('milestone-alert'), alertText: document.getElementById('alert-text'),
            celebratedList: document.getElementById('celebrated-list'), upcomingList: document.getElementById('upcoming-list'),
            body: document.body
        };

        let interval, leaderboardInterval, autoFireworksTimer, greetingTimer, isCelebrated = false, testTargetTime = null, lastAlertMinute = -1;

        // === NOTIFICATIONS (Top Left, Manual Close) ===
        function showNotification(text) {
            els.alertText.innerText = text;
            els.alert.style.display = 'flex'; // Show it
        }
        window.closeNotification = () => {
            els.alert.style.display = 'none'; // Hide it
        }

        // === SYNC & TIMER ===
        window.adjustSync = (secs) => {
            syncOffset += (secs * 1000);
            updateTimer();
            showNotification(`TV Sync Adjusted: ${syncOffset > 0 ? '+' : ''}${syncOffset/1000}s`);
        };

        function resetState() {
            if (autoFireworksTimer) clearInterval(autoFireworksTimer);
            if (greetingTimer) clearInterval(greetingTimer);
            autoFireworksTimer = null; greetingTimer = null; isCelebrated = false;
            particles = []; 
            els.body.classList.remove('heartbeat-mode'); // Clear heartbeat
            els.headline.style.display = 'block'; els.headline.innerText = "Countdown to 2026";
            els.container.style.display = 'flex'; 
            els.message.style.display = 'none';
            els.alert.style.display = 'none';
            // Remove any floating facts
            document.querySelectorAll('.floating-fact').forEach(e => e.remove());
        }

        function getTargetTime(offset = null) {
            if (testTargetTime && offset === null) return testTargetTime;
            const selection = offset !== null ? offset : els.select.value;
            let target;
            if (selection === 'local' && offset === null) {
                target = new Date(`Jan 1, ${TARGET_YEAR} 00:00:00`).getTime();
            } else {
                const val = offset !== null ? offset : parseFloat(selection);
                target = Date.UTC(TARGET_YEAR, 0, 1, 0, 0, 0) - (val * 3600000);
            }
            return target + syncOffset;
        }

        function updateTimer() {
            const target = getTargetTime();
            const now = new Date().getTime();
            const distance = target - now;

            // Notifications Logic
            const minutesLeft = Math.floor(distance / 60000);
            if (distance > 0 && minutesLeft <= 60 && minutesLeft !== lastAlertMinute) {
                 if ([60, 30, 15, 10, 5].includes(minutesLeft)) {
                    const msg = minutesLeft === 15 ? "15 Mins: Pop the Champagne! üçæ" : `${minutesLeft} Minutes Remaining!`;
                    showNotification(msg);
                    lastAlertMinute = minutesLeft;
                 }
            }

            // === HEARTBEAT MODE LOGIC (Fixed) ===
            // Starts at 10.999 seconds, ends at 0
            if (distance < 11000 && distance > 0) {
                if (!els.body.classList.contains('heartbeat-mode')) {
                    els.body.classList.add('heartbeat-mode');
                    els.headline.innerText = "GET READY!";
                }
            } else if (distance >= 11000) {
                // If we adjusted time back or reset
                els.body.classList.remove('heartbeat-mode');
                if(!isCelebrated) els.headline.innerText = `Countdown to ${TARGET_YEAR}`;
            }

            // Celebration
            if (distance < 0) {
                if (!isCelebrated) startCelebration();
                els.days.innerText = "00"; els.hours.innerText = "00"; els.minutes.innerText = "00"; els.seconds.innerText = "00";
                return;
            }

            const d = Math.floor(distance / (1000 * 60 * 60 * 24));
            const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((distance % (1000 * 60)) / 1000);

            els.days.innerText = d < 10 ? `0${d}` : d;
            els.hours.innerText = h < 10 ? `0${h}` : h;
            els.minutes.innerText = m < 10 ? `0${m}` : m;
            els.seconds.innerText = s < 10 ? `0${s}` : s;
        }

        function updateLeaderboard() {
            const now = new Date().getTime();
            let cHTML = '', uHTML = '';
            const sorted = [...timeZoneData].sort((a, b) => b.offset - a.offset);
            sorted.forEach(z => {
                const t = (Date.UTC(TARGET_YEAR, 0, 1, 0, 0, 0) - (z.offset * 3600000));
                const diff = t - now;
                if (diff <= 0) {
                    const ago = Math.abs(diff);
                    const h = Math.floor(ago/3600000); const m = Math.floor((ago%3600000)/60000);
                    cHTML += `<div class="zone-item celebrated"><span class="zone-name">‚úÖ ${z.name}</span><span class="zone-status">${h}h ${m}m ago</span></div>`;
                } else {
                    const h = Math.floor(diff/3600000); const m = Math.floor((diff%3600000)/60000); const s = Math.floor((diff%60000)/1000);
                    uHTML += `<div class="zone-item"><span class="zone-name">${z.name}</span><span class="zone-status">in ${h}h ${m}m ${s}s</span></div>`;
                }
            });
            els.celebratedList.innerHTML = cHTML || '<div style="opacity:0.5;text-align:center">No one yet!</div>';
            els.upcomingList.innerHTML = uHTML;
        }

        interval = setInterval(updateTimer, 1000);
        leaderboardInterval = setInterval(updateLeaderboard, 1000);
        updateTimer(); updateLeaderboard();

        els.select.addEventListener('change', () => { testTargetTime = null; syncOffset = 0; resetState(); updateTimer(); });
        
        // TEST BUTTON: EXACTLY 20 SECONDS
        window.testFinalCountdown = () => { 
            resetState(); 
            testTargetTime = new Date().getTime() + 20000; 
            updateTimer(); 
        }; 
        
        window.toggleFullscreen = () => { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else if (document.exitFullscreen) document.exitFullscreen(); };

        // === CELEBRATION LOGIC ===
        function startCelebration() {
            isCelebrated = true;
            els.body.classList.remove('heartbeat-mode');
            els.headline.style.display = 'none'; 
            els.container.style.display = 'none'; 
            els.message.style.display = 'block';
            els.alert.style.display = 'none'; // Auto hide alert at midnight
            
            if (!autoFireworksTimer) startAutoFireworks();
            
            // Cycle Languages
            let lIdx = 0; els.message.innerText = greetings[0];
            greetingTimer = setInterval(() => { lIdx = (lIdx + 1) % greetings.length; els.message.innerText = greetings[lIdx]; }, 2500);

            // Launch Floating Facts
            spawnFloatingFacts();
        }

        function spawnFloatingFacts() {
            facts2026.forEach((fact, index) => {
                setTimeout(() => {
                    const el = document.createElement('div');
                    el.classList.add('floating-fact');
                    el.innerText = fact;
                    el.style.left = Math.random() * 80 + 5 + '%';
                    const duration = 8 + Math.random() * 6;
                    el.style.animationDuration = `${duration}s`;
                    document.body.appendChild(el);
                    setTimeout(() => el.remove(), duration * 1000);
                }, index * 1200); 
            });
        }

        // === VISUALS ===
        const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
        let particles = [];
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resizeCanvas); resizeCanvas();
        class Particle {
            constructor(x, y, color) {
                this.x = x; this.y = y; this.color = color;
                const a = Math.random() * Math.PI * 2, s = Math.random() * 5 + 2;
                this.vx = Math.cos(a) * s; this.vy = Math.sin(a) * s; this.l = 100; this.a = 1;
            }
            u() { this.x+=this.vx; this.y+=this.vy; this.vy+=0.05; this.a-=0.01; this.l--; }
            d(c) { c.save(); c.globalAlpha = this.a; c.fillStyle = this.color; c.beginPath(); c.arc(this.x, this.y, 3, 0, Math.PI*2); c.fill(); c.restore(); }
        }
        function bang(x, y) {
            const colors = ['#ff0040', '#00ff80', '#ffeb3b', '#00e5ff', '#aa00ff'];
            const c = colors[Math.floor(Math.random() * colors.length)];
            for (let i=0; i<50; i++) particles.push(new Particle(x, y, c));
        }
        function animate() {
            ctx.fillStyle = 'rgba(0,0,0,0.2)'; ctx.fillRect(0,0,canvas.width,canvas.height);
            particles = particles.filter(p => p.l > 0); particles.forEach(p => { p.u(); p.d(ctx); });
            requestAnimationFrame(animate);
        }
        animate();
        document.addEventListener('mousedown', (e) => { if(!e.target.closest('#controls') && !e.target.closest('#milestone-alert')) bang(e.clientX, e.clientY); });
        function startAutoFireworks() { autoFireworksTimer = setInterval(() => bang(Math.random()*canvas.width, Math.random()*(canvas.height/2)), 500); }
    </script>
</body>
</html>
